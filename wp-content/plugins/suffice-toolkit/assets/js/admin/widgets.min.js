jQuery(function(a){function b(b){b.find(".suffice-toolkit-color-picker").wpColorPicker({change:_.throttle(function(){a(this).trigger("change")},3e3)})}function c(a,c){b(c)}function d(a){var b=a.find(".tg-widget-repeater-field-items"),c=b.find("li.tg-widget-accordion-item"),d=wp.template("tg-widget-repeater-field-blank");c.length?(a.find(".tg-widget-repeater-field-button").show(),c.length<sufficeToolkitLocalizeScript.i18n_max_field_entries&&a.find(".tg-widget-repeater-field-button a").removeClass("disabled")):(a.find(".tg-widget-repeater-field-button").hide(),a.find(".tg-widget-repeater-field-blank-state").remove(),b.append(d))}function e(b){b.find(".tg-widget-repeater-field-items").sortable({items:"> li",handle:"> .accordion-top > .accordion-title",cursor:"move",axis:"y",distance:2,opacity:.65,scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,placeholder:"tg-widget-sortable-placeholder",start:function(b,c){var d=c.item.children(".accordion-inside");"block"===d.css("display")&&(c.item.removeClass("open"),d.hide(),a(this).sortable("refreshPositions"))},stop:function(a,b){b.item.removeAttr("style")}})}var f;a(document.body).on("click",".tg-image-upload",function(b){var c=a(this),d=c.parent().find(".tg-media-input"),e=c.parent().parent().find(".tg-media-preview");b.preventDefault(),f=wp.media.frames.media_file=wp.media({title:c.data("choose"),button:{text:c.data("update")},states:[new wp.media.controller.Library({title:c.data("choose"),library:wp.media.query({type:"image"})})]}),f.on("select",function(){var a=f.state().get("selection").first().toJSON();d.val(a.url),e.css({display:"none"}).find("img").remove(),e.css({display:"block"}).append('<img src="'+a.url+'">')}),f.open()}),a(document.body).on("click",".tg-media-remove",function(){var b=a(this).closest(".media-uploader");return b.find(".tg-media-input").val(""),b.find(".tg-media-preview").css({display:"none"}).find("img").remove(),!1}),a(document.body).on("suffice-toolkit-init-media-preview",function(){a("input.tg-media-input").each(function(){var b=a(this).val(),c=a(this).parent().siblings(".tg-media-preview");""!==b&&(c.find("img.tg-media-preview-default").remove(),c.css({display:"block"}).append('<img src="'+b+'">'))})}).trigger("suffice-toolkit-init-media-preview"),a(document).on("widget-added widget-updated",c),a(document.body).on("suffice-toolkit-color-picker",function(){a("#widgets-right .widget:has(.suffice-toolkit-color-picker)").each(function(){b(a(this))})}).trigger("suffice-toolkit-color-picker"),a(document.body).on("panelsopen",function(){function b(a){a.wpColorPicker()}a("input.suffice-toolkit-color-picker").each(function(){b(a(this))})}),a(document.body).on("suffice-toolkit-tabs",function(){a(document.body).on("click",".suffice-tab-title-container .suffice-tab-title",function(b){b.preventDefault(),a(this).addClass("active"),a(this).siblings().removeClass("active");var c=a(this).attr("href");a(this).parent().siblings(".suffice-toolkit-tab-content-container").find(".suffice-toolkit-tab").css("display","none"),a(this).parent().siblings(".suffice-toolkit-tab-content-container").find(c).fadeIn()})}).trigger("suffice-toolkit-tabs"),a(document.body).on("suffice-toolkit-init-availability",function(){a("select.icon_chooser").change(function(){"image"===a(this).val()?(a(this).closest("p").next(".show_if_icon").hide(),a(this).closest("p").next().next(".show_if_image").show()):(a(this).closest("p").next(".show_if_icon").show(),a(this).closest("p").next().next(".show_if_image").hide())}).change(),a("select.media_chooser").change(function(){"image"===a(this).val()?(a(this).closest(".widget-content").find(".show_if_image").show(),a(this).closest(".widget-content").find(".show_if_video").closest("p").hide()):(a(this).closest(".widget-content").find(".show_if_image").hide(),a(this).closest(".widget-content").find(".show_if_video").closest("p").show())}).change(),a("select.filter_availability").change(function(){"0"===a(this).val()?a(this).closest(".widget-content").find(".show_if_all_category").closest("p").show():a(this).closest(".widget-content").find(".show_if_all_category").closest("p").hide()}).change(),a("select").change(function(){"post-style-carousel"===a(this).val()?a(this).closest("p").next("p").hide():a(this).closest("p").next("p").show()}).change(),a("select.availability").change(function(){"latest"===a(this).val()?a(this).closest("p").next("p").hide():a(this).closest("p").next("p").show()}).change(),a("select.cta-style").change(function(){"cta-boxed-one"===a(this).val()?a(this).parents("p").siblings().find("input.show_if_not_hexagon").parent("p").hide():a(this).parents("p").siblings().find("input.show_if_not_hexagon").parent("p").show()}).change(),a("input.availability").change(function(){a(this).is(":checked")?a(this).closest("p").next("p").hide():a(this).closest("p").next("p").show()}).change()}).trigger("suffice-toolkit-init-availability"),a(document.body).on("suffice-toolkit-init-accordion-title",function(){a(".tg-widget-repeater-field-items").children("li").each(function(){var b=a('input[id*="-title"]',this).val()||"";b&&(b=": "+b.replace(/<[^<>]+>/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;")),a(this).children(".accordion-top").children(".accordion-title").children().children(".in-accordion-title").html(b)})}).trigger("suffice-toolkit-init-accordion-title"),a(document.body).on("click",".tg-widget-repeater-field-add",function(b){if(b.preventDefault(),a(this).is(".disabled"))return void window.alert(sufficeToolkitLocalizeScript.i18n_max_field_message);var c=a(this).parents(".widget-content"),d=c.find("li.tg-widget-accordion-item").length+1,e=c.find(".tg-widget-repeater-field-items").data("widget_id"),f=wp.template("tg-widget-repeater-field-"+e);c.find("li.tg-widget-accordion-item").each(function(b,c){d===parseInt(a(c).data("id").replace(/[^0-9\.]/g,""),10)&&d++}),c.find(".tg-widget-repeater-field-button").show(),c.find(".tg-widget-repeater-field-blank-state").remove(),c.find(".tg-widget-repeater-field-items").append(f({field_id:d})),d>=sufficeToolkitLocalizeScript.i18n_max_field_entries&&c.find(".tg-widget-repeater-field-button a").addClass("disabled"),a(document.body).trigger("suffice-enhanced-select-init")}),a(document.body).on("click.accordion-toggle",function(b){var c,e,f,g=a(b.target);g.parents(".accordion-top").length&&!g.parents("#available-fields").length?(c=g.closest("li.tg-widget-accordion-item"),e=c.children(".accordion-inside"),e.is(":hidden")?(c.addClass("open"),e.slideDown("fast")):e.slideUp("fast",function(){c.attr("style",""),c.removeClass("open")}),b.preventDefault()):g.hasClass("accordion-control-close")?(c=g.closest("li.tg-widget-accordion-item"),c.children(".accordion-inside").slideUp("fast",function(){c.attr("style",""),c.removeClass("open")}),b.preventDefault()):g.hasClass("accordion-control-remove")&&(c=g.closest("li.tg-widget-accordion-item"),f=g.parents(".widget[id*=themegrill_suffice], .widget-content"),c.remove(),d(f),b.preventDefault())}),a(document.body).on("panelsopen",function(b){var c=a(b.target);return!!c.has(".tg-widget-repeater-field-items")&&(c.addClass("widget-content"),d(c),e(c),a(document.body).trigger("suffice-enhanced-select-init"),a(document.body).trigger("suffice-toolkit-init-availability"),a(document.body).trigger("suffice-toolkit-init-media-preview"),void a(document.body).trigger("suffice-toolkit-init-accordion-title"))}),a(document.body).on("click",".so-close",function(){a(document.body).trigger("suffice-toolkit-init-accordion-title")}),a(document.body).on("click","div.widget[id*=themegrill_suffice] .widget-title, div.widget[id*=themegrill_suffice] .widget-title-action",function(){a(this).parents("#available-widgets").length||(d(a(this).parents(".widget[id*=themegrill_suffice]")),e(a(this).parents(".widget[id*=themegrill_suffice]")))}),a(document).on("widget-added widget-updated",function(b,c){c.is("[id*=themegrill_suffice]")&&(b.preventDefault(),d(c),e(c),a(document.body).trigger("suffice-enhanced-select-init"),a(document.body).trigger("suffice-toolkit-init-availability"),a(document.body).trigger("suffice-toolkit-init-media-preview"),a(document.body).trigger("suffice-toolkit-init-accordion-title"))})});